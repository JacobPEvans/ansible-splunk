---
# Splunk Docker role defaults

# Docker configuration
splunk_docker_package_name: docker.io
splunk_docker_compose_package: docker-compose-plugin

# Splunk container configuration
# Splunk image - use :latest or pin a specific version like 9.1.2 when upgrading.
# Note: If specifying a version not yet pulled, ensure the VM has network access to Docker Hub.
splunk_docker_image: splunk/splunk:latest
splunk_docker_hostname: splunk
splunk_docker_container_name: splunk

# Splunk credentials (from Doppler) - set in playbook vars
splunk_docker_password: ""
splunk_docker_hec_token: ""

# Splunk ports
splunk_docker_web_port: 8000
splunk_docker_hec_port: 8088

# Splunk Web SSL (enableSplunkWebSSL)
splunk_docker_web_ssl: true

# Splunk data directories
splunk_docker_data_dir: /opt/splunk
splunk_docker_var_dir: "{{ splunk_docker_data_dir }}/var"
splunk_docker_etc_dir: "{{ splunk_docker_data_dir }}/etc"

# Splunk configuration directory (for compose and configs)
splunk_docker_config_dir: /opt/splunk-config

# Index retention defaults
# 100 GiB in MiB: 100 * 1024 = 102400 MiB (approx. "100GB" index size)
# 365 days in seconds: 365 * 24 * 60 * 60 = 31536000 seconds
splunk_docker_index_default_max_size_mb: 102400
splunk_docker_index_default_frozen_time_secs: 31536000

# Indexes to create
splunk_docker_indexes:
  - name: firewall
    max_size_mb: "{{ splunk_docker_index_default_max_size_mb }}"
    frozen_time_secs: "{{ splunk_docker_index_default_frozen_time_secs }}"
  - name: netflow
    max_size_mb: "{{ splunk_docker_index_default_max_size_mb }}"
    frozen_time_secs: "{{ splunk_docker_index_default_frozen_time_secs }}"
  - name: network
    max_size_mb: "{{ splunk_docker_index_default_max_size_mb }}"
    frozen_time_secs: "{{ splunk_docker_index_default_frozen_time_secs }}"
  - name: os
    max_size_mb: "{{ splunk_docker_index_default_max_size_mb }}"
    frozen_time_secs: "{{ splunk_docker_index_default_frozen_time_secs }}"
  - name: unifi
    max_size_mb: "{{ splunk_docker_index_default_max_size_mb }}"
    frozen_time_secs: "{{ splunk_docker_index_default_frozen_time_secs }}"


# Firewall configuration
# DISABLED: Proxmox firewall is the single source of truth for network security.
# Guest-level iptables rules conflict with Docker's FORWARD chain and break
# container port forwarding. See terraform-proxmox/modules/firewall for rules.
splunk_docker_firewall_enabled: false

# Service user - IMPORTANT: Use splunk user UID inside container (41812)
# NOT root. This ensures proper file ownership for Splunk apps.
splunk_docker_user: "41812"
splunk_docker_group: "41812"

# Technology Add-ons (TAs) to install
# TAs must be placed in roles/splunk_docker/files/ as .tar, .tgz, or .spl files
splunk_docker_unifi_ta_version: 1.0.2+00b9ecb
splunk_docker_duck_yeah_version: 234
splunk_docker_addons:
  - name: TA-unifi-cloud
    filename: "TA-unifi-cloud-{{ splunk_docker_unifi_ta_version }}.tar"
    description: UniFi Cloud Add-on for Splunk (syslog parsing and field extraction)
  - name: Duck Yeah
    filename: "duck-yeah_{{ splunk_docker_duck_yeah_version }}.tgz"
    description: Duck Yeah - Splunk app for packaging and app management
