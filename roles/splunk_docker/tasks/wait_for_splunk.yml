---
# Reusable health check - included by main.yml (initial start) and
# site.yml post_tasks (after handler-triggered restarts).
- name: Wait for Splunk to be ready
  ansible.builtin.uri:
    url: "{{ 'https' if splunk_docker_web_ssl else 'http' }}://127.0.0.1:{{ splunk_docker_web_port }}/en-US/account/login"
    validate_certs: false
  register: splunk_docker_health
  until: splunk_docker_health.status == 200
  retries: 36
  delay: 10
  when: splunk_docker_wait_enabled
