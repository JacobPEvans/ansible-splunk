---
# Splunk Docker Compose configuration
# Generated by Ansible

services:
  splunk:
    image: {{ splunk_docker_image }}
    hostname: {{ splunk_docker_hostname }}
    container_name: {{ splunk_docker_container_name }}
    user: root
    environment:
      SPLUNK_START_ARGS: "--accept-license"
      SPLUNK_GENERAL_TERMS: "--accept-sgt-current-at-splunk-com"
      SPLUNK_PASSWORD: "{{ splunk_docker_password }}"
      SPLUNK_HEC_TOKEN: "{{ splunk_docker_hec_token }}"
    ports:
      - "{{ splunk_docker_web_port }}:8000"
      - "{{ splunk_docker_hec_port }}:8088"
    volumes:
      - {{ splunk_docker_var_dir }}:/opt/splunk/var
      - {{ splunk_docker_etc_dir }}:/opt/splunk/etc
      - {{ splunk_docker_config_dir }}/indexes.conf:/opt/splunk/etc/system/local/indexes.conf:ro
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "-k", "https://localhost:8089/services/server/health"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 120s
