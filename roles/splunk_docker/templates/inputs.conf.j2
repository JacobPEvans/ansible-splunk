# Splunk inputs configuration
# Generated by Ansible — 1 HEC token per index

[http]
disabled = 0
index = main

{% for idx in splunk_docker_indexes %}
{% set token_val = splunk_docker_hec_token_values[idx.name] | default('') %}
{% if token_val | length > 0 %}
[http://{{ idx.name }}]
token = {{ token_val }}
disabled = 0
description = HEC token for {{ idx.name }} index
index = {{ idx.name }}
indexes = {{ idx.name }}

{% endif %}
{% endfor %}
{% set legacy_val = splunk_docker_hec_token_values['legacy'] | default('') %}
{% if legacy_val | length > 0 %}
[http://legacy]
token = {{ legacy_val }}
disabled = 0
description = Legacy shared token — remove after all senders migrated
index = main
indexes = {{ (['main'] + (splunk_docker_indexes | map(attribute='name') | list)) | join(',') }}
{% endif %}
